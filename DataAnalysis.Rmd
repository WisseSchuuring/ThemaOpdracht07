---
title: "DataAnalysis"
author: "Wisse Schuuring"
date: "2/15/2022"
output: pdf_document
---

```{r setup, include=FALSE}

library(ggplot2)
library(dplyr)
library(xtable)


```

# Exploratory Data Analysis


```{r}
#reading in the parental sample files.
sample_1_p <- read.csv(file = "Data/Samples/Reformat/GSM3733674_1_p.csv",
                       header=T)
sample_4_p <- read.csv(file = "Data/Samples/Reformat/GSM3733677_4_p.csv",
                       header=T)
sample_5_p <- read.csv(file = "Data/Samples/Reformat/GSM3733678_5_p.csv",
                       header=T)

#reading in the IRF2 knockout files.
sample_2_KO <- read.csv(file = "Data/Samples/Reformat/GSM3733675_2_KO.csv",
                        header=T)
sample_3_KO <- read.csv(file = "Data/Samples/Reformat/GSM3733676_3_KO.csv",
                        header=T)
sample_6_KO <- read.csv(file = "Data/Samples/Reformat/GSM3733679_6_KO.csv",
                        header=T)

#removing the "values" value in both parental and knockout files.
s1p <- sample_1_p[c("ID_REF", "count")]
s4p <- sample_4_p[c("ID_REF", "count")]
s5p <- sample_5_p[c("ID_REF", "count")]

s2k <- sample_2_KO[c("ID_REF", "count")]
s3k <- sample_3_KO[c("ID_REF", "count")]
s6k <- sample_6_KO[c("ID_REF", "count")]
```

Read in the files and removed the unnecessary value value, for the only ones of interest are the id and the counts value.


```{r}
# Merge the parental data
first_merge_parental <- merge(s1p, s4p, by="ID_REF")
final_merge_parental <- merge(first_merge_parental, s5p, by="ID_REF")
names(final_merge_parental)[2] <- c("counts_1_p")
names(final_merge_parental)[3] <- c("counts_4_p")
names(final_merge_parental)[4] <- c("counts_5_p")
final_merge_parental$counts_total_p <- rowSums(final_merge_parental[2:4])


# Merge the IRF2KO data
first_merge_IRF2KO <- merge(s2k, s3k, by="ID_REF")
final_merge_IRF2KO <- merge(first_merge_parental, s6k, by="ID_REF")
names(final_merge_IRF2KO)[2] <- c("counts_2_KO")
names(final_merge_IRF2KO)[3] <- c("counts_3_KO")
names(final_merge_IRF2KO)[4] <- c("counts_6_KO")
final_merge_IRF2KO$counts_total_KO <- rowSums(final_merge_IRF2KO[2:4])


# Merge both datasets into a completed dataset
MyData <- merge(final_merge_parental, final_merge_IRF2KO, by="ID_REF")

# Write the merged dataset to a seperate file " MyData.csv".
write.csv(MyData,file = 'Data/Samples/Reformat/MyData.csv', row.names=F)

```

With the data finally cleaned up, a simple read.table() shall reveal its contents.

```{r}
# Reading the first five rows of MyData.csv file into R as a table.
read.table(file="Data/Samples/Reformat/MyData.csv", sep=",",
           header=T, nrows = 5)


```

The data set contains the identifier for the gene, followed by the amount of times this gene has been expressed within it's respective sample. In addition, there are "total" columns with the sum of these counts for the IRF2 Knockout samples, and the parental samples. These can be used for comparison's sake. All of these values are integers, therefore easy to work with.

```{r}
# Reading the data set as MyData
MyData <- read.csv(file = "Data/Samples/Reformat/MyData.csv", header = T)

#Show the amount of rows and columns in MyData
Dimensions <- dim(MyData)
cat("The data set contains", Dimensions[1],
    "rows and",Dimensions[2],"columns.\n")

#Show the structure of the data set.
str(MyData)
cat("All values within the data set are integers,
    as expected from a numeric value such as a count.\n")
```

```{r}
# create R objects to store classification
counts_p <- 2:4
counts_KO <- 6:8
counts_total <- c(5,9)
compare_1_2 <- c(2,6)
compare_4_3 <- c(3,7)
compare_5_6 <- c(4,8)

```

Six R objects are created. The counts objects to keep track of individual counts, as well as a comparison between both totals. The compare objects compare one specific parental expression count value with one specific IRF2 Knockout expression count value. 

I need to compare the counts on the Y values from both count_total_p and count_total_KO to the genes on the X bar. 
```{r}
# boxplot(counts_p)
# boxplot(counts_KO)
# count_compare <- ggplot(counts_total, aes(x=counts_total_p, y=counts_total_KO)) + geom_point() +  scale_x_continuous() +
#   geom_jitter()
# count_compare
#ggplot(counts_total, aes(x=counts_total_KO, y=ID_REF))
boxplot(MyData$counts_total_p ~ MyData$ID_REF)
boxplot(MyData$counts_total_KO ~ MyData$ID_REF)

```
```{r}
summary(MyData)
```



